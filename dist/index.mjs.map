{"version":3,"sources":["../src/AnalyticsTracker.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useLocation, useNavigationType } from \"react-router-dom\";\r\n\r\n\r\nfunction getOrCreateClientId() {\r\n    const key = \"oAnalytics_id\";\r\n    let id = localStorage.getItem(key);\r\n    if (!id) {\r\n        id = crypto.randomUUID(); // or use your own generator\r\n        localStorage.setItem(key, id);\r\n    }\r\n    return id;\r\n}\r\n\r\nexport const AnalyticsTracker = (\r\n    { appId }: { appId: string }\r\n) => {\r\n    const location = useLocation();\r\n    const navType = useNavigationType();\r\n\r\n    const [sessionId] = useState(() => crypto.randomUUID());\r\n\r\n\r\n    useEffect(() => {\r\n        async function send() {\r\n            const payload = {\r\n                session_id: sessionId,\r\n                client_id: getOrCreateClientId(),\r\n                path: location.pathname + location.search + location.hash,\r\n                search: location.search,\r\n                hash: location.hash,\r\n                navigationType: navType,\r\n                timestamp: Date.now(),\r\n                userAgent: navigator.userAgent,\r\n                referrer: document.referrer || \"direct\",\r\n                app_id: \"ec2e4fe5-e46d-459d-895c-6618a57aae83\"\r\n            };\r\n\r\n            // navigator.sendBeacon(\"http://localhost:3000/log\", JSON.stringify(payload));\r\n\r\n\r\n            const response = await fetch(\"http://localhost:3001/log\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(payload),\r\n            });\r\n            const result = await response.json();\r\n            console.log(result);\r\n        }\r\n\r\n        send()\r\n    }, [location, navType]);\r\n\r\n    return null;\r\n};\r\n\r\n"],"mappings":";AAAA,SAAS,WAAW,gBAAgB;AACpC,SAAS,aAAa,yBAAyB;AAG/C,SAAS,sBAAsB;AAC3B,QAAM,MAAM;AACZ,MAAI,KAAK,aAAa,QAAQ,GAAG;AACjC,MAAI,CAAC,IAAI;AACL,SAAK,OAAO,WAAW;AACvB,iBAAa,QAAQ,KAAK,EAAE;AAAA,EAChC;AACA,SAAO;AACX;AAEO,IAAM,mBAAmB,CAC5B,EAAE,MAAM,MACP;AACD,QAAM,WAAW,YAAY;AAC7B,QAAM,UAAU,kBAAkB;AAElC,QAAM,CAAC,SAAS,IAAI,SAAS,MAAM,OAAO,WAAW,CAAC;AAGtD,YAAU,MAAM;AACZ,mBAAe,OAAO;AAClB,YAAM,UAAU;AAAA,QACZ,YAAY;AAAA,QACZ,WAAW,oBAAoB;AAAA,QAC/B,MAAM,SAAS,WAAW,SAAS,SAAS,SAAS;AAAA,QACrD,QAAQ,SAAS;AAAA,QACjB,MAAM,SAAS;AAAA,QACf,gBAAgB;AAAA,QAChB,WAAW,KAAK,IAAI;AAAA,QACpB,WAAW,UAAU;AAAA,QACrB,UAAU,SAAS,YAAY;AAAA,QAC/B,QAAQ;AAAA,MACZ;AAKA,YAAM,WAAW,MAAM,MAAM,6BAA6B;AAAA,QACtD,QAAQ;AAAA,QACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,QAC9C,MAAM,KAAK,UAAU,OAAO;AAAA,MAChC,CAAC;AACD,YAAM,SAAS,MAAM,SAAS,KAAK;AACnC,cAAQ,IAAI,MAAM;AAAA,IACtB;AAEA,SAAK;AAAA,EACT,GAAG,CAAC,UAAU,OAAO,CAAC;AAEtB,SAAO;AACX;","names":[]}